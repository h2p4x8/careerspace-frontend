<template>
  <div class='header' >
    <v-container text-xs-center :style="position" :class="{'header-on-mainpage': !isShow}">
      <v-layout row header-box :justify-center='$vuetify.breakpoint.smAndDown'>
        <v-flex logo md2 shrink offset-xs2>
          <router-link to="/">
            <v-layout row fill-height style='padding-top: 5px'>
              <v-flex shrink logo-icon>
              <svg width="189" height="34" viewBox="0 0 189 34" fill="none" xmlns="http://www.w3.org/2000/svg" v-if='$vuetify.breakpoint.mdAndUp'>
                <path d="M17.162 21.4194C17.9527 16.4035 16.867 9.92927 10.9363 4C5.00565 9.92927 4.00063 16.4035 4.8044 21.4194M17.162 21.4194C22.2292 24.8065 21.4432 28.9677 19.5405 34C19.1151 32.0645 17.5853 28.0968 14.8692 27.7097M17.162 21.4194C16.7571 23.9884 15.8598 26.1749 14.8692 27.7097M14.8692 27.7097C14.6372 28.0692 14.4 28.3929 14.1628 28.6774H7.70977C7.48842 28.3929 7.26475 28.0692 7.04414 27.7097M4.8044 21.4194C-0.35673 24.8065 0.718782 29.6452 2.33212 34C2.86982 31.5806 3.93038 28.871 7.04414 27.7097M4.8044 21.4194C5.21607 23.9884 6.10224 26.1749 7.04414 27.7097M10.9362 14.1613C7.1719 14.1613 7.23568 20 11 20C14.7643 20 14.7005 14.1613 10.9362 14.1613Z" stroke="#009954"/>
                <path d="M44.3594 15.3281C43.75 12.6094 41.2969 10.5 37.9219 10.5C33.5625 10.5 30.75 13.7656 30.75 18.875C30.75 24.0312 33.5625 27.25 37.9219 27.25C41.2188 27.25 43.6719 25.375 44.3281 22.6562H43.1094C42.4688 24.75 40.5469 26.1562 37.9375 26.1562C34.2812 26.1562 31.9688 23.3438 31.9688 18.875C31.9688 14.4375 34.2812 11.5938 37.9219 11.5938C40.5938 11.5938 42.5469 13.1719 43.1562 15.3281H44.3594ZM52.2656 26.1875C49.75 26.1875 47.9375 24.7031 47.9375 22.625C47.9375 20.4688 49.5938 19.1875 52.6406 18.9531L58.0625 18.5625V20.9688C58.0625 23.8594 55.4688 26.1875 52.2656 26.1875ZM52.0938 27.25C54.8125 27.25 57.25 25.7188 58.0781 23.5156H58.1094V27H59.2812V16.0156C59.2812 12.625 57.0625 10.5 53.5 10.5C49.9531 10.5 47.6094 12.4531 47.2969 15.4688H48.4688C48.875 13.0156 50.6562 11.5938 53.4844 11.5938C56.3594 11.5938 58.0625 13.2969 58.0625 16.1094V17.5625L52.4688 17.9531C48.7188 18.25 46.7188 19.8438 46.7188 22.625C46.7188 25.3594 48.9219 27.25 52.0938 27.25ZM62.7656 27H63.9844V16.875C63.9844 13.8281 65.5625 11.6562 68.125 11.6562C68.8906 11.6562 69.4688 11.8125 69.8125 11.9844V10.7656C69.5156 10.6406 68.9375 10.5 68.2969 10.5C66.1406 10.5 64.6094 11.7188 63.9375 13.9531H63.9062V10.75H62.7656V27ZM77.2188 11.5781C80.6406 11.5781 82.9375 14.2188 82.9531 18.0625H71.3594C71.5312 14.1875 73.8438 11.5781 77.2188 11.5781ZM82.7812 22.4531C82.2969 24.5781 80.3594 26.1719 77.375 26.1719C73.7344 26.1719 71.3438 23.5625 71.3438 19.1406V19.0781H84.2031V18.3906C84.2031 13.6719 81.4375 10.5 77.2344 10.5C72.9375 10.5 70.1094 13.8438 70.1094 18.8906C70.1094 24.1406 72.9375 27.25 77.3594 27.25C80.9844 27.25 83.4531 25.2031 84 22.4531H82.7812ZM93.2812 11.5781C96.7031 11.5781 99 14.2188 99.0156 18.0625H87.4219C87.5938 14.1875 89.9062 11.5781 93.2812 11.5781ZM98.8438 22.4531C98.3594 24.5781 96.4219 26.1719 93.4375 26.1719C89.7969 26.1719 87.4062 23.5625 87.4062 19.1406V19.0781H100.266V18.3906C100.266 13.6719 97.5 10.5 93.2969 10.5C89 10.5 86.1719 13.8438 86.1719 18.8906C86.1719 24.1406 89 27.25 93.4219 27.25C97.0469 27.25 99.5156 25.2031 100.062 22.4531H98.8438ZM103.047 27H104.266V16.875C104.266 13.8281 105.844 11.6562 108.406 11.6562C109.172 11.6562 109.75 11.8125 110.094 11.9844V10.7656C109.797 10.6406 109.219 10.5 108.578 10.5C106.422 10.5 104.891 11.7188 104.219 13.9531H104.188V10.75H103.047V27ZM111.734 14.9062C111.734 16.9844 113.125 18.2812 116.172 19L118.516 19.5469C121.125 20.1719 122.156 21.0781 122.156 22.7969C122.156 24.7969 120.219 26.2031 117.438 26.2031C114.719 26.2031 112.703 24.6719 112.406 22.4219H111.203C111.453 25.25 114 27.25 117.406 27.25C120.906 27.25 123.375 25.375 123.375 22.7188C123.375 20.4375 122.109 19.25 118.875 18.4844L116.625 17.9531C114.016 17.3438 112.922 16.4375 112.922 14.8594C112.922 12.9375 114.75 11.5469 117.266 11.5469C119.859 11.5469 121.609 13 121.938 15.4062H123.109C122.812 12.3906 120.562 10.5 117.281 10.5C114.047 10.5 111.734 12.3438 111.734 14.9062ZM133.328 10.5C130.312 10.5 128.016 12.5 127.266 15.1094H127.219V10.75H126.078V32.3281H127.297V22.7344H127.328C128.047 25.2656 130.344 27.25 133.344 27.25C137.422 27.25 140.219 23.875 140.219 18.875C140.219 13.875 137.406 10.5 133.328 10.5ZM133.188 26.1562C129.703 26.1562 127.281 23.1875 127.281 18.875C127.281 14.5625 129.703 11.5938 133.188 11.5938C136.641 11.5938 138.984 14.5469 138.984 18.8906C138.984 23.2188 136.641 26.1562 133.188 26.1562ZM148.078 26.1875C145.562 26.1875 143.75 24.7031 143.75 22.625C143.75 20.4688 145.406 19.1875 148.453 18.9531L153.875 18.5625V20.9688C153.875 23.8594 151.281 26.1875 148.078 26.1875ZM147.906 27.25C150.625 27.25 153.062 25.7188 153.891 23.5156H153.922V27H155.094V16.0156C155.094 12.625 152.875 10.5 149.312 10.5C145.766 10.5 143.422 12.4531 143.109 15.4688H144.281C144.688 13.0156 146.469 11.5938 149.297 11.5938C152.172 11.5938 153.875 13.2969 153.875 16.1094V17.5625L148.281 17.9531C144.531 18.25 142.531 19.8438 142.531 22.625C142.531 25.3594 144.734 27.25 147.906 27.25ZM171.438 15.6562C170.953 12.75 168.438 10.5 164.922 10.5C160.578 10.5 157.766 13.75 157.766 18.875C157.766 24.0469 160.562 27.25 164.938 27.25C168.391 27.25 170.938 25.1875 171.422 22.2344H170.219C169.719 24.5625 167.703 26.1562 164.938 26.1562C161.297 26.1562 158.984 23.3594 158.984 18.875C158.984 14.4219 161.297 11.5938 164.938 11.5938C167.734 11.5938 169.75 13.3281 170.234 15.6562H171.438ZM180.406 11.5781C183.828 11.5781 186.125 14.2188 186.141 18.0625H174.547C174.719 14.1875 177.031 11.5781 180.406 11.5781ZM185.969 22.4531C185.484 24.5781 183.547 26.1719 180.562 26.1719C176.922 26.1719 174.531 23.5625 174.531 19.1406V19.0781H187.391V18.3906C187.391 13.6719 184.625 10.5 180.422 10.5C176.125 10.5 173.297 13.8438 173.297 18.8906C173.297 24.1406 176.125 27.25 180.547 27.25C184.172 27.25 186.641 25.2031 187.188 22.4531H185.969Z" fill="#009954"/>
              </svg>
              <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" v-else>
              <circle cx="20" cy="20" r="20" fill="#009954"/>
                <path d="M23.1628 29.6774H16.7098C16.4884 29.3929 16.2647 29.0692 16.0441 28.7097C12.9304 29.871 11.8698 32.5806 11.3321 35C9.71878 30.6452 8.64327 25.8064 13.8044 22.4194C13.0006 17.4035 14.0056 10.9293 19.9363 5C25.867 10.9293 26.9527 17.4035 26.162 22.4194C31.2292 25.8064 30.4432 29.9677 28.5405 35C28.1151 33.0645 26.5853 29.0968 23.8692 28.7097C23.6372 29.0692 23.4 29.3929 23.1628 29.6774Z" fill="white"/>
                <path d="M26.162 22.4194C26.9527 17.4035 25.867 10.9293 19.9363 5C14.0056 10.9293 13.0006 17.4035 13.8044 22.4194M26.162 22.4194C31.2292 25.8065 30.4432 29.9677 28.5405 35C28.1151 33.0645 26.5853 29.0968 23.8692 28.7097M26.162 22.4194C25.7571 24.9884 24.8598 27.1749 23.8692 28.7097M23.8692 28.7097C23.6372 29.0692 23.4 29.3929 23.1628 29.6774H16.7098C16.4884 29.3929 16.2647 29.0692 16.0441 28.7097M13.8044 22.4194C8.64327 25.8065 9.71878 30.6452 11.3321 35C11.8698 32.5806 12.9304 29.871 16.0441 28.7097M13.8044 22.4194C14.2161 24.9884 15.1022 27.1749 16.0441 28.7097M19.9362 15.1613C16.1719 15.1613 16.2357 21 20 21C23.7643 21 23.7005 15.1613 19.9362 15.1613Z" stroke="#009954"/>
              </svg>
              </v-flex>
            </v-layout>
          </router-link>
        </v-flex>

        <v-flex xs2 offset-xs3 align-self-center v-if="$vuetify.breakpoint.mdAndUp">
          <v-layout text-xs-center :class="isShow ? 'nav_link' : 'greeting_nav'" align-center>

            <v-flex shrink>
              <router-link :to="{ name: 'AuthPage', query: { type: 'login' }}" class="link login">Войти</router-link>
            </v-flex>

            <v-flex grow>
              <router-link :to="{ name: 'AuthPage', query: { type: 'signup' }}" class="link signup">Зарегистрироваться</router-link>
            </v-flex>
          </v-layout>
        </v-flex>

      </v-layout>
    </v-container>
  </div>
</template>

<script>
import LoginForm from "./LoginForm.vue";
import DropdownMenu from "./DropdownMenu.vue";
import DropdownMenuInMyPage from './DropdownMenuInMyPage.vue'
import LogOut from "./LogOut.vue";
import { mapGetters, mapActions } from "vuex";

export default {
  components: {
    LoginForm,
    LogOut,
    DropdownMenu,
    DropdownMenuInMyPage
  },
  data() {
    return {
      links:[
        {
          href: 'https://t.me/bezaspera',
          title: 'Блог'
        }
      ],
      routerLinks: [
        {
          to: '/jobs',
          title: 'Вакансии'
        },
      ],
    }
  },
  computed: {
    ...mapGetters('Auth', [
      "isAuthenticated",
    ]),
    ...mapGetters('UserPage', [
      'getUserInfo'
    ]),
    isShow() {
      return this.$vuetify.breakpoint.xsOnly;
    },
    getAllLinks() {
      const newlinkList = [];

      this.routerLinks.forEach( el => newlinkList.push(el))
      this.links.forEach( el =>  newlinkList.push(el) )

      return newlinkList;
    },
    position() {
      return this.isShow ? {position: 'static', zIndex: 'auto'} : { position: 'absolute', zIndex: '5', maxWidth: '100%'};
    }
  },
  mounted(){
    if (this.isAuthenticated) this.refreshUserInfo();
  },
  methods: {
    ...mapActions('UserPage', [
      'refreshUserInfo'
    ]),
  }
}

</script>
